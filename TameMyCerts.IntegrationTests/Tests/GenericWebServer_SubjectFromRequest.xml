<CertificateRequestPolicy xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <MinimumKeyLength>2048</MinimumKeyLength>
  <MaximumKeyLength>3072</MaximumKeyLength>
  <SupplementDnsNames>true</SupplementDnsNames>
  <ReadSubjectFromRequest>true</ReadSubjectFromRequest>
  <Subject>
    <SubjectRule>
      <Field>commonName</Field>
      <Mandatory>true</Mandatory>
      <MaxOccurrences>3</MaxOccurrences>
      <MaxLength>64</MaxLength>
      <Patterns>
        <Pattern>
          <Expression>^[-_a-zA-Z0-9]*(\.intra)?(\.tmctests\.internal)$</Expression>
        </Pattern>
        <Pattern>
          <Expression>^this-is-a-test$</Expression>
        </Pattern>
        <Pattern>
          <Expression>192.168.0.0/24</Expression>
          <TreatAs>Cidr</TreatAs>
        </Pattern>
        <Pattern>
          <Expression>^.*(porn|gambling).*$</Expression>
          <Action>Deny</Action>
        </Pattern>
      </Patterns>
    </SubjectRule>
    <SubjectRule>
      <Field>countryName</Field>
      <Mandatory>false</Mandatory>
      <MaxLength>2</MaxLength>
      <Patterns>
        <Pattern>
          <Expression>^DE$</Expression>
        </Pattern>
      </Patterns>
    </SubjectRule>
    <SubjectRule>
      <Field>OID.1.2.3.4</Field>
      <Mandatory>false</Mandatory>
      <MaxLength>64</MaxLength>
      <Patterns>
        <Pattern>
          <Expression>^test$</Expression>
        </Pattern>
      </Patterns>
    </SubjectRule>
  </Subject>
</CertificateRequestPolicy>