<CertificateRequestPolicy xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Subject>
    <SubjectRule>
      <Field>commonName</Field>
      <Mandatory>true</Mandatory>
      <MaxLength>64</MaxLength>
      <Patterns>
        <Pattern>
          <Expression>^[a-zA-Z0-9]*$</Expression>
        </Pattern>
      </Patterns>
    </SubjectRule>
  </Subject>
  <SubjectAlternativeName>
    <SubjectRule>
      <Field>userPrincipalName</Field>
      <Mandatory>true</Mandatory>
      <MaxLength>64</MaxLength>
      <Patterns>
        <Pattern>
          <Expression>^[a-zA-Z0-9]*(\@tamemycerts-tests\.local)$</Expression>
        </Pattern>
      </Patterns>
    </SubjectRule>
  </SubjectAlternativeName>
  <DirectoryServicesMapping />
  <OutboundSubject>
    <OutboundSubjectRule>
      <Field>emailAddress</Field>
      <Value>{ad:mail}</Value>
      <Mandatory>true</Mandatory>
    </OutboundSubjectRule>
    <OutboundSubjectRule>
      <Field>commonName</Field>
      <Value>{ad:displayName}</Value>
      <Mandatory>true</Mandatory>
      <Force>true</Force>
    </OutboundSubjectRule>
    <OutboundSubjectRule>
      <Field>organizationName</Field>
      <Value>{ad:company}</Value>
      <Mandatory>true</Mandatory>
    </OutboundSubjectRule>
    <OutboundSubjectRule>
      <Field>organizationalUnitName</Field>
      <Value>{ad:department}</Value>
      <Mandatory>true</Mandatory>
    </OutboundSubjectRule>
    <OutboundSubjectRule>
      <Field>localityName</Field>
      <Value>{ad:l}</Value>
      <Mandatory>true</Mandatory>
    </OutboundSubjectRule>
    <OutboundSubjectRule>
      <Field>stateOrProvinceName</Field>
      <Value>{ad:st}</Value>
      <Mandatory>true</Mandatory>
    </OutboundSubjectRule>
    <OutboundSubjectRule>
      <Field>countryName</Field>
      <Value>{ad:c}</Value>
      <Mandatory>true</Mandatory>
    </OutboundSubjectRule>
    <OutboundSubjectRule>
      <Field>title</Field>
      <Value>{ad:title}</Value>
      <Mandatory>true</Mandatory>
    </OutboundSubjectRule>
    <OutboundSubjectRule>
      <Field>givenName</Field>
      <Value>{ad:givenName}</Value>
      <Mandatory>true</Mandatory>
    </OutboundSubjectRule>
    <OutboundSubjectRule>
      <Field>surname</Field>
      <Value>{ad:sn}</Value>
      <Mandatory>true</Mandatory>
    </OutboundSubjectRule>
    <OutboundSubjectRule>
      <Field>streetAddress</Field>
      <Value>{ad:streetAddress}</Value>
      <Mandatory>true</Mandatory>
    </OutboundSubjectRule>
  </OutboundSubject>
</CertificateRequestPolicy>